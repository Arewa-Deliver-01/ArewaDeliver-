<!doctype html>
<html lang="en"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Ongoing Delivery — Rider</title><link rel="stylesheet" href="style.css"/></head><body>
<header><div class="logo">ArewaDeliver</div><nav><a href="rider_dashboard.html">Dashboard</a><a href="available_jobs.html">Available Jobs</a><a href="wallet.html">Wallet</a></nav></header>

<main style="max-width:1000px;margin:20px auto;padding:12px">
  <h2>Ongoing Deliveries</h2>
  <div id="ongoingList"></div>
</main>

<script>
(function(){
  const jobsAll = JSON.parse(localStorage.getItem('arewa_jobs')||'{}');
  const session = JSON.parse(localStorage.getItem('arewa_session')||'null');
  const uid = session? session.user_id : null;
  const jobs = jobsAll[uid] || [];
  function render(){
    const el = document.getElementById('ongoingList');
    el.innerHTML = jobs.filter(j=>j.status==='ongoing').map(j=>`
      <div class="order-row">
        <div><strong>${j.id}</strong><div class="muted">${j.pickup} → ${j.drop}</div></div>
        <div style="text-align:right">
          <div>₦${j.pay}</div>
          <div style="margin-top:8px"><button class="btn outline" onclick="completeJob('${j.id}')">Mark Delivered</button> <button class="btn" onclick="viewJob('${j.id}')">View</button></div>
        </div>
      </div>
    `).join('') || '<p class="muted">No ongoing deliveries</p>';
  }
  window.completeJob = function(id){
    const idx = jobs.findIndex(j=>j.id===id);
    if(idx>=0){ jobs[idx].status='completed'; localStorage.setItem('arewa_jobs', JSON.stringify(jobsAll)); alert('Marked delivered'); render(); }
  };
  window.viewJob = function(id){ localStorage.setItem('arewa_selected_job', id); location.href='delivery_details.html'; };
  render();
})();
</script>
</body></html>
