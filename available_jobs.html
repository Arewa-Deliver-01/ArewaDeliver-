<!doctype html>
<html lang="en"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Available Jobs — Rider</title><link rel="stylesheet" href="style.css"/></head><body>
<header><div class="logo">ArewaDeliver</div><nav><a href="rider_dashboard.html">Dashboard</a><a href="ongoing_delivery.html">Ongoing Delivery</a><a href="wallet.html">Wallet</a></nav></header>

<main style="max-width:1000px;margin:20px auto;padding:12px">
  <h2>Available Jobs</h2>
  <div id="jobList"></div>
</main>

<script>
(function(){
  const session = JSON.parse(localStorage.getItem('arewa_session')||'null');
  const uid = session? session.user_id : null;
  const jobsAll = JSON.parse(localStorage.getItem('arewa_jobs')||'{}');
  if(!jobsAll[uid]) jobsAll[uid] = [
    {id:'J-7001', pickup:'City Market', drop:'Unguwar Rimi', pay:600, status:'available'},
    {id:'J-7002', pickup:'New Watch', drop:'Kofar Soro', pay:900, status:'available'}
  ];
  localStorage.setItem('arewa_jobs', JSON.stringify(jobsAll));
  const jobs = jobsAll[uid];

  function render(){
    const el = document.getElementById('jobList');
    el.innerHTML = jobs.map(j=>`
      <div class="order-row">
        <div><strong>${j.id}</strong><div class="muted">${j.pickup} → ${j.drop}</div></div>
        <div style="text-align:right">
          <div>₦${j.pay}</div>
          <div style="margin-top:8px"><button class="btn" onclick="acceptJob('${j.id}')">Accept</button> <button class="btn outline" onclick="viewJob('${j.id}')">View</button></div>
        </div>
      </div>
    `).join('') || '<p class="muted">No jobs</p>';
  }

  window.acceptJob = function(id){
    const idx = jobs.findIndex(j=>j.id===id);
    if(idx>=0){ jobs[idx].status='ongoing'; localStorage.setItem('arewa_jobs', JSON.stringify(jobsAll)); alert('Job accepted'); render(); }
  };
  window.viewJob = function(id){ localStorage.setItem('arewa_selected_job', id); location.href='delivery_details.html'; };

  render();
})();
</script>
</body></html>
