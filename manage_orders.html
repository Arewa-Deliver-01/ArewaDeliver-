<!doctype html>
<html lang="en"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Manage Orders</title><link rel="stylesheet" href="style.css"/></head><body>
<header><div class="logo">ArewaDeliver</div><nav><a href="vendor_dashboard.html">Dashboard</a><a href="new_orders.html">New Orders</a><a href="wallet.html">Wallet</a></nav></header>

<main style="max-width:1000px;margin:20px auto;padding:12px">   <h2>Manage Orders</h2>
  <div id="manageList" style="margin-top:12px"></div>
</main>

<script>
(function(){
  const session = JSON.parse(localStorage.getItem('arewa_session')||'null');
  const uid = session? session.user_id : null;
  const all = JSON.parse(localStorage.getItem('arewa_new_orders')||'{}');
  const orders = all[uid] || [];

  function render(){
    const el = document.getElementById('manageList');
    el.innerHTML = orders.map(o=>`
      <div style="padding:12px;background:#fff;border-radius:12px;margin-bottom:8px;display:flex;justify-content:space-between;align-items:center">
        <div><strong>${o.id}</strong><div class="muted">${o.customer} • ${o.pickup} → ${o.drop}</div><div class="muted">Status: ${o.status}</div></div>
        <div>
          <select onchange="changeStatus('${o.id}', this.value)">
            <option value="new" ${o.status==='new'?'selected':''}>New</option>
            <option value="accepted" ${o.status==='accepted'?'selected':''}>Accepted</option>
            <option value="ongoing" ${o.status==='ongoing'?'selected':''}>Ongoing</option>
            <option value="delivered" ${o.status==='delivered'?'selected':''}>Delivered</option>
          </select>
          <button class="btn outline" onclick="viewOrder('${o.id}')">View</button>
        </div>
      </div>
    `).join('') || '<p class="muted">No orders found</p>';
  }

  window.changeStatus = function(id, status){
    const idx = orders.findIndex(o=>o.id===id);
    if(idx>=0){ orders[idx].status = status; localStorage.setItem('arewa_new_orders', JSON.stringify(all)); render(); alert('Status updated'); }
  };
  window.viewOrder = function(id){ localStorage.setItem('arewa_selected_order', id); location.href='delivery_details.html'; };

  render();
})();
</script>
</body></html>
